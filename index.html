<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale-1.0">
    <title>App Zoobotânico - Protótipo</title>
    <!-- Carrega o Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Fonte Inter (padrão do Tailwind) */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }
        
        /* Esconde as setas do input number */
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
            -webkit-appearance: none; 
            margin: 0; 
        }
        input[type=number] {
            -moz-appearance: textfield;
        }

        /* Classe utilitária para esconder a barra de rolagem visual */
        .no-scrollbar::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Edge */
        }
        .no-scrollbar {
            -ms-overflow-style: none;  /* IE e Edge */
            scrollbar-width: none;  /* Firefox */
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

    <!-- Container principal do "app" -->
    <div class="max-w-md w-full bg-white rounded-2xl shadow-xl overflow-hidden" style="min-height: 80vh; max-height: 95vh; display: flex; flex-direction: column;">
        
        <!-- Conteúdo rolável (com classe no-scrollbar adicionada) -->
        <div class="flex-grow overflow-y-auto no-scrollbar">

            <!-- Tela de Login (View 1) -->
            <div id="loginScreen">
                <div class="p-6">
                    <div class="text-center pt-8 pb-4">
                        <!-- Ícone de Folha (referência ao "Botânico") -->
                        <div class="bg-emerald-600 w-20 h-20 rounded-full mx-auto flex items-center justify-center mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 12c0 5.13-4.17 9.3-9.3 9.3-4.8 0-8.8-3.6-9.2-8.3C.9 12.6, 1 12.1, 1.2 11.7c.2-.4.4-.8.7-1.1.3-.3.6-.6 1-1 .4-.3.8-.6 1.2-.8.4-.2.9-.4 1.3-.5.5-.1 1-.1 1.5-.1 3.5 0 6.5 2 8.1 4.9.2.3.3.6.4.9.2.3.3.6.3.9.1.3.1.6.1 1z" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M12.5 21.5c-1.6 0-3.1-.4-4.5-1.1-1.4-.7-2.6-1.7-3.5-2.9C3.6 16.3,3 15,3 13.5c0-1.2.4-2.3 1.1-3.3.7-1 1.6-1.8 2.7-2.4.5-.3 1-.5 1.5-.7.5-.1 1-.2 1.5-.2.6 0 1.2.1 1.8.2.6.1 1.1.3 1.6.5.5.2 1 .5 1.4.8.4.3.8.7 1.1 1.1.3.4.6.8.8 1.2.2.4.3.9.3 1.3" />
                            </svg>
                        </div>
                        <h1 class="text-2xl font-bold text-gray-800">App Zoobotânico</h1>
                        <p class="text-gray-500 text-sm">Agendamento de Visitas</p>
                    </div>

                    <form class="space-y-4 pt-4" onsubmit="event.preventDefault(); showView('homeScreen');">
                        <div>
                            <label for="cpf" class="block text-sm font-medium text-gray-700">CPF ou E-mail</label>
                            <input type="text" id="cpf" class="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500" placeholder="Digite seu CPF ou e-mail" value="visitante@email.com">
                        </div>

                        <div>
                            <label for="senha" class="block text-sm font-medium text-gray-700">Senha</label>
                            <!-- Container para ver/ocultar senha -->
                            <div class="relative mt-1">
                                <input type="password" id="senha" class="block w-full px-4 py-3 pr-10 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500" placeholder="••••••••" value="123456">
                                <button type="button" id="togglePassword" class="absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 hover:text-emerald-600">
                                    <svg id="eyeIcon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z" />
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                    </svg>
                                    <svg id="eyeSlashIcon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 hidden">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L6.228 6.228" />
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <div class="text-right">
                            <button type="button" onclick="showView('forgotPasswordScreen')" class="text-sm font-medium text-emerald-600 hover:text-emerald-500">
                                Esqueci a senha
                            </button>
                        </div>

                        <button type="submit" class="w-full bg-emerald-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-emerald-700 transition duration-300 shadow-md">
                            Entrar
                        </button>

                        <!-- Botões de Login Social -->
                        <div class="space-y-3 pt-4">
                            <button type="button" class="w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 transition duration-300 shadow-md flex items-center justify-center space-x-2">
                                <!-- Ícone Gov.br -->
                                <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M5.5 12C5.5 8.13 8.13 5 12 5C15.87 5 18.5 8.13 18.5 12C18.5 15.87 15.87 19 12 19C8.13 19 5.5 15.87 5.5 12Z" fill="#00A859"/>
                                    <path d="M12 3L3 12L12 21L21 12L12 3Z" fill="#FFC72C" stroke="#FFC72C" stroke-width="1.5"/>
                                    <circle cx="12" cy="12" r="4.5" fill="#002776"/>
                                </svg>
                                <span>Entrar com Gov.br</span>
                            </button>
                            <!-- Botão Google -->
                            <button type="button" class="w-full bg-white text-gray-700 py-3 px-4 rounded-lg font-semibold transition duration-300 shadow-md border border-gray-300 hover:bg-gray-50 flex items-center justify-center space-x-2">
                                <svg class="w-5 h-5" viewBox="0 0 48 48">
                                    <path fill="#4285F4" d="M24 9.5c3.54 0 6.7 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.02 13.97 17.6 9.5 24 9.5z"></path>
                                    <path fill="#34A853" d="M46.98 24.55c0-1.57-.15-3.09-.42-4.55H24v8.61h12.8c-.54 2.78-2.19 5.16-4.63 6.79v5.62h7.24c4.24-3.89 6.68-9.66 6.68-16.47z"></path>
                                    <path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-3-.76-4.59s.27-3.14.76-4.59V13.22H2.56C.97 16.14 0 19.98 0 24c0 4.02.97 7.86 2.56 10.78l7.97-6.19z"></path>
                                    <path fill="#EA4335" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.24-5.62c-2.15 1.45-4.92 2.3-8.65 2.3-6.4 0-11.98-4.47-13.95-10.46l-7.98 6.19C6.51 42.62 14.62 48 24 48z"></path>
                                    <path fill="none" d="M0 0h48v48H0z"></path>
                                </svg>
                                <span>Entrar com Google</span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Tela Principal (Home) (View 2) -->
            <div id="homeScreen" class="hidden">
                <div class="p-6">
                    <header class="flex justify-between items-center mb-6">
                        <div>
                            <h1 class="text-2xl font-bold text-gray-800">Meus Agendamentos</h1>
                            <p class="text-gray-500">Olá, Visitante!</p>
                        </div>
                        <div class="flex items-center space-x-4">
                            <!-- Botão Editar Perfil -->
                            <button onclick="showView('editProfileScreen')" class="text-gray-500 hover:text-emerald-600" aria-label="Editar Perfil">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                  <path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10" />
                                </svg>
                            </button>
                            <button onclick="showView('loginScreen')" class="text-sm text-red-500 hover:text-red-700 font-medium">Sair</button>
                        </div>
                    </header>

                    <!-- Seção de Agendamentos Futuros -->
                    <div>
                        <h2 class="text-lg font-semibold text-gray-700 mb-3">Próxima Visita</h2>
                        <!-- Card de Agendamento (Dinâmico) - Oculto por padrão -->
                        <div id="nextVisitCard" class="bg-emerald-50 border border-emerald-200 rounded-lg p-4 mb-4 shadow-sm hidden cursor-pointer hover:bg-emerald-100 transition">
                            <div class="flex justify-between items-center" id="nextVisitDetails">
                                <!-- Conteúdo será preenchido pelo JS -->
                            </div>
                        </div>

                        <!-- Mensagem de "Nenhuma visita" - Mostrada por padrão -->
                        <div id="noNextVisit" class="bg-gray-50 rounded-lg p-4 text-center border border-gray-200">
                            <p class="text-gray-600">Nenhuma visita futura agendada.</p>
                        </div>

                        <!-- Mensagem para novo agendamento -->
                        <div class="bg-gray-50 rounded-lg p-4 text-center mt-4">
                            <p class="text-gray-600">Deseja agendar uma nova visita?</p>
                            <button onclick="startBooking()" class="mt-3 w-full bg-emerald-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-emerald-700 transition duration-300 shadow-md">
                                Agendar Nova Visita
                            </button>
                        </div>
                    </div>

                    <!-- Histórico de Agendamentos -->
                    <div class="mt-8">
                        <h2 class="text-lg font-semibold text-gray-700 mb-3">Histórico de Visitas</h2>
                        <!-- Container do Histórico (para novos itens) -->
                        <div id="historyList" class="space-y-2">
                            <!-- Mensagem de Histórico Vazio (Mostrada por padrão) -->
                            <div id="historyEmpty" class="bg-white border border-gray-200 rounded-lg p-4 text-center text-gray-500 text-sm">
                                Nenhum histórico de visitas.
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Tela de Agendamento (View 3) -->
            <div id="scheduleScreen" class="hidden">
                <div class="p-6">
                    <header class="flex items-center mb-6">
                        <button onclick="showView('homeScreen')" class="text-gray-600 hover:text-gray-900 p-2 -ml-2 rounded-full" aria-label="Voltar">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                            </svg>
                        </button>
                        <h1 class="text-xl font-bold text-gray-800 mx-auto pr-6">Novo Agendamento</h1>
                    </header>

                    <!-- Passo 1: Quantidade de Visitantes -->
                    <div class="mb-5">
                        <label for="visitors" class="block text-sm font-medium text-gray-700 mb-2">Quantos visitantes? (Máx. 5)</label>
                        <div class="flex items-center justify-center space-x-4">
                            <button id="decrementVisitors" class="bg-gray-200 text-gray-700 rounded-full w-10 h-10 flex items-center justify-center text-2xl font-bold hover:bg-gray-300" aria-label="Diminuir visitantes">-</button>
                            <input type="number" id="visitors" value="1" min="1" max="5" class="w-20 text-center text-xl font-bold border-transparent focus:border-transparent focus:ring-0" readonly>
                            <button id="incrementVisitors" class="bg-emerald-600 text-white rounded-full w-10 h-10 flex items-center justify-center text-2xl font-bold hover:bg-emerald-700" aria-label="Aumentar visitantes">+</button>
                        </div>
                    </div>

                    <!-- Passo 2: Calendário -->
                    <div class="mb-5">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Escolha uma data</label>
                        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-4">
                            <div class="flex justify-between items-center mb-3">
                                <button id="prevMonth" class="text-gray-600 hover:text-gray-900 p-1 rounded-full disabled:opacity-50" aria-label="Mês anterior">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                                    </svg>
                                </button>
                                <span id="monthYear" class="text-lg font-semibold text-gray-800"></span>
                                <button id="nextMonth" class="text-gray-600 hover:text-gray-900 p-1 rounded-full" aria-label="Próximo mês">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                                    </svg>
                                </button>
                            </div>
                            <div id="calendarWeekdays" class="grid grid-cols-7 gap-1 text-center text-xs text-gray-500 mb-2">
                                <span>Dom</span><span>Seg</span><span>Ter</span><span>Qua</span><span>Qui</span><span>Sex</span><span>Sáb</span>
                            </div>
                            <div id="calendarGrid" class="grid grid-cols-7 gap-1 text-center">
                                <!-- Dias do calendário serão gerados pelo JS -->
                            </div>
                        </div>
                    </div>

                    <!-- Passo 3: Horários Disponíveis -->
                    <div id="timeSlotsContainer" class="mb-6 hidden">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Escolha um horário</label>
                        <div id="timeSlots" class="grid grid-cols-3 gap-2">
                            <!-- Horários serão preenchidos pelo JS -->
                            <button class="time-slot p-3 border border-gray-300 rounded-lg hover:border-emerald-500 hover:bg-emerald-50 transition">09:00</button>
                            <button class="time-slot p-3 border border-gray-300 rounded-lg hover:border-emerald-500 hover:bg-emerald-50 transition">10:00</button>
                            <button class="time-slot p-3 border border-gray-300 rounded-lg hover:border-emerald-500 hover:bg-emerald-50 transition">11:00</button>
                            <button class="time-slot p-3 border border-gray-300 rounded-lg hover:border-emerald-500 hover:bg-emerald-50 transition">13:00</button>
                            <button class="time-slot p-3 border border-gray-300 rounded-lg hover:border-emerald-500 hover:bg-emerald-50 transition">14:00</button>
                            <button class="time-slot p-3 border border-gray-300 rounded-lg text-gray-400 bg-gray-50 cursor-not-allowed" disabled>15:00</button>
                            <button class="time-slot p-3 border border-gray-300 rounded-lg hover:border-emerald-500 hover:bg-emerald-50 transition">16:00</button>
                        </div>
                    </div>

                    <!-- Passo 4: Confirmar -->
                    <button id="confirmBookingButton" onclick="confirmBooking()" class="w-full bg-emerald-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-emerald-700 transition duration-300 shadow-md disabled:bg-gray-400" disabled>
                        Confirmar Agendamento
                    </button>

                </div>
            </div>

            <!-- Tela de Confirmação (View 4) -->
            <div id="confirmationScreen" class="hidden">
                <div class="p-6 text-center">
                    <div class="bg-emerald-100 w-24 h-24 rounded-full mx-auto flex items-center justify-center mb-6 mt-8">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-emerald-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                    </div>
                    <h1 class="text-2xl font-bold text-gray-800 mb-2">Agendamento Confirmado!</h1>
                    <p class="text-gray-600 mb-6">Sua visita ao Zoobotânico foi agendada com sucesso.</p>

                    <!-- Detalhes do Agendamento -->
                    <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 text-left space-y-3 mb-8">
                        <div>
                            <span class="block text-xs font-medium text-gray-500">Local</span>
                            <span class="block text-sm font-semibold text-gray-800">Zoobotânico Municipal</span>
                        </div>
                        <div id="confirmationDetails">
                            <!-- Detalhes preenchidos pelo JS -->
                        </div>
                    </div>

                    <p class="text-xs text-gray-500 mb-6">Um lembrete será enviado para seu e-mail. Chegue com 15 minutos de antecedência.</p>

                    <button onclick="showView('homeScreen')" class="w-full bg-white text-emerald-700 border border-emerald-600 py-3 px-4 rounded-lg font-semibold hover:bg-emerald-50 transition duration-300">
                        Voltar ao Início
                    </button>
                </div>
            </div>

            <!-- NOVA TELA: Esqueci a Senha (View 5) -->
            <div id="forgotPasswordScreen" class="hidden">
                <div class="p-6">
                    <header class="flex items-center mb-6">
                        <button onclick="showView('loginScreen'); resetForgotForm();" class="text-gray-600 hover:text-gray-900 p-2 -ml-2 rounded-full" aria-label="Voltar">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                            </svg>
                        </button>
                        <h1 class="text-xl font-bold text-gray-800 mx-auto pr-6">Recuperar Senha</h1>
                    </header>

                    <!-- Formulário de Recuperação -->
                    <div id="forgotForm">
                        <p class="text-gray-600 text-sm mb-4">Digite seu e-mail abaixo para enviarmos um link de recuperação de senha.</p>
                        <form class="space-y-4" onsubmit="event.preventDefault(); requestPasswordReset();">
                            <div>
                                <label for="forgotEmail" class="block text-sm font-medium text-gray-700">E-mail</label>
                                <input type="email" id="forgotEmail" class="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500" placeholder="seuemail@exemplo.com" required>
                            </div>
                            <button type="submit" class="w-full bg-emerald-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-emerald-700 transition duration-300 shadow-md">
                                Enviar Link
                            </button>
                        </form>
                    </div>

                    <!-- Mensagem de Sucesso -->
                    <div id="forgotSuccess" class="hidden text-center mt-8">
                        <div class="bg-emerald-100 w-20 h-20 rounded-full mx-auto flex items-center justify-center mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-10 h-10 text-emerald-600">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75" />
                            </svg>
                        </div>
                        <h2 class="text-xl font-bold text-gray-800">Link Enviado!</h2>
                        <p class="text-gray-600 text-sm mt-2">Verifique sua caixa de entrada e siga as instruções para redefinir sua senha.</p>
                    </div>

                </div>
            </div>

            <!-- NOVA TELA: Editar Perfil (View 6) -->
            <div id="editProfileScreen" class="hidden">
                <div class="p-6">
                    <header class="flex items-center mb-6">
                        <button onclick="showView('homeScreen')" class="text-gray-600 hover:text-gray-900 p-2 -ml-2 rounded-full" aria-label="Voltar">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                            </svg>
                        </button>
                        <h1 class="text-xl font-bold text-gray-800 mx-auto pr-6">Editar Perfil</h1>
                    </header>

                    <!-- Mensagem de Sucesso (Oculta) -->
                    <div id="editProfileSuccess" class="hidden bg-emerald-100 border border-emerald-300 text-emerald-800 px-4 py-3 rounded-lg mb-4 text-sm">
                        Perfil atualizado com sucesso!
                    </div>

                    <form class="space-y-4" onsubmit="event.preventDefault(); saveProfile();">
                        <div>
                            <label for="editName" class="block text-sm font-medium text-gray-700">Nome Completo</label>
                            <input type="text" id="editName" class="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500" value="Visitante">
                        </div>
                        <div>
                            <label for="editEmail" class="block text-sm font-medium text-gray-700">E-mail</label>
                            <input type="email" id="editEmail" class="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500" value="visitante@email.com">
                        </div>
                        <div>
                            <label for="editCPF" class="block text-sm font-medium text-gray-700">CPF</label>
                            <input type="text" id="editCPF" class="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm bg-gray-100 cursor-not-allowed" value="123.456.789-00" readonly>
                        </div>

                        <div class="pt-2">
                            <h3 class="text-md font-semibold text-gray-700">Alterar Senha</h3>
                        </div>
                        
                        <div>
                            <label for="newPassword" class="block text-sm font-medium text-gray-700">Nova Senha</labe >
                            <input type="password" id="newPassword" class="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500" placeholder="Deixe em branco para não alterar">
                        </div>
                        <div>
                            <label for="confirmNewPassword" class="block text-sm font-medium text-gray-700">Confirmar Nova Senha</label>
                            <input type="password" id="confirmNewPassword" class="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500" placeholder="Repita a nova senha">
                        </div>

                        <button type="submit" class="w-full bg-emerald-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-emerald-700 transition duration-300 shadow-md">
                            Salvar Alterações
                        </button>
                    </form>
                </div>
            </div>

        </div> <!-- Fim do conteúdo rolável -->
    </div> <!-- Fim do container principal -->

    <script>
        // --- GERENCIAMENTO DE ESTADO E NAVEGAÇÃO ---

        // Armazena a visualização (tela) atual que o usuário está vendo
        let currentView = 'loginScreen';
        
        // Objeto global para armazenar os detalhes do agendamento em andamento
        const bookingDetails = {
            visitors: 1,
            date: null,
            time: null
        };
        
        // Armazena a data que o calendário está exibindo (para navegar entre meses)
        let calendarDate = new Date();
        
        // Armazena a data de "hoje", zerada, para comparações
        const today = new Date();
        today.setHours(0, 0, 0, 0); // Zera o horário para desabilitar dias passados

        // Mapeamento de todas as "telas" (Views) do aplicativo
        const views = {
            loginScreen: document.getElementById('loginScreen'),
            homeScreen: document.getElementById('homeScreen'),
            scheduleScreen: document.getElementById('scheduleScreen'),
            confirmationScreen: document.getElementById('confirmationScreen'),
            forgotPasswordScreen: document.getElementById('forgotPasswordScreen'),
            editProfileScreen: document.getElementById('editProfileScreen')
        };

        /**
         * @param {string} viewId O ID da tela (view) para mostrar.
         * Esta é a função principal de navegação. Ela esconde todas as telas
         * e depois exibe apenas a tela solicitada.
         */
        function showView(viewId) {
            // Esconde todas as telas
            for (let id in views) {
                if (views[id]) {
                    views[id].classList.add('hidden');
                }
            }

            // Se o usuário está voltando para a tela de login (fazendo "logout"),
            // chamamos a função para resetar o estado da tela principal.
            if (viewId === 'loginScreen' && currentView !== 'loginScreen') {
                resetAppToDefault();
            }

            // Mostra a tela desejada
            if (views[viewId]) {
                views[viewId].classList.remove('hidden');
                currentView = viewId;
            } else {
                console.error("View (tela) não encontrada: ", viewId);
            }
        }

        /**
         * Reseta a tela principal ao estado inicial.
         * Chamado quando o usuário faz "logout" (volta para a tela de login).
         */
        function resetAppToDefault() {
            // Reseta o card de "Próxima Visita"
            document.getElementById('nextVisitCard').classList.add('hidden');
            document.getElementById('noNextVisit').classList.remove('hidden');
            document.getElementById('nextVisitDetails').innerHTML = '';

            // Reseta a lista de "Histórico"
            const historyList = document.getElementById('historyList');
            historyList.innerHTML = `
                <div id="historyEmpty" class="bg-white border border-gray-200 rounded-lg p-4 text-center text-gray-500 text-sm">
                    Nenhum histórico de visitas.
                </div>
            `;
            
            // Reseta os formulários (opcional, mas bom para protótipos)
            document.getElementById('cpf').value = 'visitante@email.com';
            document.getElementById('senha').value = '123456';
            if (document.getElementById('senha').type === 'text') {
                togglePasswordVisibility(); // Reseta o ícone de olho
            }
            resetForgotForm();
        }


        // --- LÓGICA DA TELA DE AGENDAMENTO (View 3) ---

        /**
         * Inicia o fluxo de um novo agendamento.
         * Reseta os dados do último agendamento e prepara a tela.
         */
        function startBooking() {
            // 1. Reseta o objeto de detalhes do agendamento
            bookingDetails.visitors = 1;
            bookingDetails.date = null;
            bookingDetails.time = null;
            
            // 2. Reseta a UI (campos do formulário)
            document.getElementById('visitors').value = 1;
            document.getElementById('timeSlotsContainer').classList.add('hidden');
            document.getElementById('confirmBookingButton').disabled = true;

            // 3. Remove seleções visuais anteriores do calendário e horários
            clearSelections(document.querySelectorAll('.time-slot'));
            clearSelections(document.querySelectorAll('.day-cell'));

            // 4. Renderiza o calendário para o mês atual
            calendarDate = new Date(); // Garante que começa no mês atual
            renderCalendar();
            
            // 5. Mostra a tela de agendamento
            showView('scheduleScreen');
        }

        // --- LÓGICA DO CONTADOR DE VISITANTES ---
        
        const visitorsInput = document.getElementById('visitors');
        const incrementVisitorsBtn = document.getElementById('incrementVisitors');
        const decrementVisitorsBtn = document.getElementById('decrementVisitors');

        incrementVisitorsBtn.addEventListener('click', () => {
            let count = parseInt(visitorsInput.value);
            if (count < 5) { // Limite de 5 visitantes
                count++;
                visitorsInput.value = count;
                bookingDetails.visitors = count;
            }
        });

        decrementVisitorsBtn.addEventListener('click', () => {
            let count = parseInt(visitorsInput.value);
            if (count > 1) { // Mínimo de 1 visitante
                count--;
                visitorsInput.value = count;
                bookingDetails.visitors = count;
            }
        });

        // --- LÓGICA DO CALENDÁRIO ---

        // Elementos do DOM para o calendário
        const monthYearLabel = document.getElementById('monthYear');
        const calendarGrid = document.getElementById('calendarGrid');
        const prevMonthBtn = document.getElementById('prevMonth');
        const nextMonthBtn = document.getElementById('nextMonth');

        // Nomes dos meses para exibição
        const monthNames = ["Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"];

        /**
         * Desenha o calendário na tela para o mês e ano em `calendarDate`.
         * Desabilita dias passados e Segundas-feiras.
         */
        function renderCalendar() {
            const month = calendarDate.getMonth();
            const year = calendarDate.getFullYear();

            // Define o título (ex: "Outubro 2025")
            monthYearLabel.textContent = `${monthNames[month]} ${year}`;
            calendarGrid.innerHTML = ''; // Limpa o calendário anterior

            // Informações sobre o mês
            const firstDayOfMonth = new Date(year, month, 1).getDay(); // 0 (Dom) - 6 (Sáb)
            const daysInMonth = new Date(year, month + 1, 0).getDate(); // Pega o último dia do mês atual

            // Desabilita o botão "anterior" se estivermos no mês atual
            prevMonthBtn.disabled = (year === today.getFullYear() && month === today.getMonth());
            
            // 1. Preenche os dias vazios no início do grid
            for (let i = 0; i < firstDayOfMonth; i++) {
                calendarGrid.innerHTML += `<div class="w-10 h-10"></div>`;
            }

            // 2. Preenche os dias do mês
            for (let day = 1; day <= daysInMonth; day++) {
                const dayDate = new Date(year, month, day);
                const isPast = dayDate < today; // Verifica se a data já passou
                
                // Zoobotânico fecha às Segundas-feiras (getDay() === 1)
                const dayOfWeek = dayDate.getDay();
                const isClosedDay = dayOfWeek === 1; // 1 = Segunda-feira

                let classes = 'day-cell w-10 h-10 flex items-center justify-center rounded-full cursor-pointer transition';
                let isDisabled = false;

                // Desabilita o botão se for no passado ou dia de fechamento
                if (isPast || isClosedDay) {
                    classes += ' text-gray-400 bg-gray-50 cursor-not-allowed';
                    isDisabled = true;
                } else {
                    classes += ' text-gray-700 hover:bg-emerald-50';
                }
                
                // Adiciona o botão do dia ao grid
                calendarGrid.innerHTML += `<button class="${classes}" data-date="${dayDate.toISOString()}" ${isDisabled ? 'disabled' : ''}>${day}</button>`;
            }
        }

        // Listeners para navegar entre os meses
        prevMonthBtn.addEventListener('click', () => {
            calendarDate.setMonth(calendarDate.getMonth() - 1);
            renderCalendar();
            clearDayAndTimeSelection(); // Reseta a seleção de dia e hora
        });

        nextMonthBtn.addEventListener('click', () => {
            calendarDate.setMonth(calendarDate.getMonth() + 1);
            renderCalendar();
            clearDayAndTimeSelection(); // Reseta a seleção de dia e hora
        });
        
        // Reseta a seleção de dia e hora (usado ao trocar de mês)
        function clearDayAndTimeSelection() {
            bookingDetails.date = null;
            bookingDetails.time = null;
            document.getElementById('timeSlotsContainer').classList.add('hidden');
            document.getElementById('confirmBookingButton').disabled = true;
            clearSelections(document.querySelectorAll('.time-slot'));
        }

        // --- LÓGICA DE SELEÇÃO (Calendário e Horário) ---

        // Adiciona um listener de clique ao grid do calendário (usando delegação de evento)
        calendarGrid.addEventListener('click', (e) => {
            // Verifica se o clique foi em um botão de dia (`day-cell`) e se não está desabilitado
            if (e.target.classList.contains('day-cell') && !e.target.disabled) {
                // Remove seleção visual anterior
                clearSelections(calendarGrid.querySelectorAll('.day-cell'));
                
                // Adiciona nova seleção visual
                e.target.classList.add('bg-emerald-600', 'text-white', 'font-bold');
                e.target.classList.remove('hover:bg-emerald-50');
                
                // Salva a data no estado
                bookingDetails.date = new Date(e.target.dataset.date);
                
                // Mostra os horários e reseta a seleção de horário anterior
                document.getElementById('timeSlotsContainer').classList.remove('hidden');
                bookingDetails.time = null;
                document.getElementById('confirmBookingButton').disabled = true;
                clearSelections(document.querySelectorAll('.time-slot'));
            }
        });

        // Adiciona listener aos horários (usando delegação de evento)
        const timeSlotsContainer = document.getElementById('timeSlots');
        timeSlotsContainer.addEventListener('click', (e) => {
            // Verifica se o clique foi em um botão de horário (`time-slot`) e se não está desabilitado
            if (e.target.classList.contains('time-slot') && !e.target.disabled) {
                // Remove seleção visual anterior
                clearSelections(timeSlotsContainer.querySelectorAll('.time-slot'));

                // Adiciona nova seleção visual
                e.target.classList.add('bg-emerald-600', 'text-white', 'font-bold');
                e.target.classList.remove('hover:border-emerald-500', 'hover:bg-emerald-50');

                // Salva o horário no estado
                bookingDetails.time = e.target.textContent;

                // Habilita o botão de confirmar
                checkIfBookingIsReady();
            }
        });
        
        /**
         * @param {NodeListOf<Element>} elements Uma lista de elementos (dias ou horários).
         * Remove as classes de "selecionado" de todos os elementos.
         */
        function clearSelections(elements) {
            elements.forEach(el => {
                el.classList.remove('bg-emerald-600', 'text-white', 'font-bold');
                if (!el.disabled) {
                    el.classList.add('hover:bg-emerald-50'); // Readiciona hover
                    if(el.classList.contains('time-slot')) {
                         el.classList.add('hover:border-emerald-500');
                    }
                }
            });
        }

        // Verifica se todos os dados (data, hora, visitantes) estão preenchidos para habilitar o botão
        function checkIfBookingIsReady() {
            const { date, time, visitors } = bookingDetails;
            if (date && time && visitors > 0) {
                document.getElementById('confirmBookingButton').disabled = false;
            } else {
                document.getElementById('confirmBookingButton').disabled = true;
            }
        }

        // --- LÓGICA DA TELA DE CONFIRMAÇÃO (View 4) ---

        /**
         * Chamada ao clicar em "Confirmar Agendamento".
         * Atualiza a tela principal (Home) e mostra a tela de confirmação.
         */
        function confirmBooking() {
            if (!bookingDetails.date || !bookingDetails.time) return;

            // Formata a data para exibição (ex: "28 de Outubro, 2025")
            const formattedDate = bookingDetails.date.toLocaleDateString('pt-BR', {
                day: '2-digit',
                month: 'long',
                year: 'numeric'
            });

            const visitorsText = `${bookingDetails.visitors} ${bookingDetails.visitors > 1 ? 'Pessoas' : 'Pessoa'}`;

            // 1. ATUALIZA A TELA PRINCIPAL (HOME)
            
            // Atualiza o card de "Próxima Visita"
            const nextVisitDetails = document.getElementById('nextVisitDetails');
            nextVisitDetails.innerHTML = `
                <div>
                    <span class="block text-sm font-medium text-emerald-700">Zoobotânico Municipal</span>
                    <span class="block text-lg font-bold text-emerald-900">${formattedDate}</span>
                    <span class="block text-sm text-emerald-800">${bookingDetails.time} • ${visitorsText}</span>
                </div>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-emerald-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                </svg>
            `;
            document.getElementById('nextVisitCard').classList.remove('hidden');
            document.getElementById('noNextVisit').classList.add('hidden');

            // Adiciona o item ao Histórico
            const historyList = document.getElementById('historyList');
            const historyEmpty = document.getElementById('historyEmpty');
            
            // Remove a mensagem de "histórico vazio" se ela existir
            if (historyEmpty) {
                historyEmpty.remove();
            }

            // Cria o novo elemento de histórico
            const newHistoryItem = document.createElement('div');
            newHistoryItem.className = 'bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:bg-gray-50 transition cursor-pointer';
            newHistoryItem.innerHTML = `
                <span class="block text-sm font-medium text-gray-600">${formattedDate}</span>
                <span class="block text-xs text-gray-500">${bookingDetails.time} • ${visitorsText} • Agendado</span>
            `;
            
            // Adiciona no topo da lista (prepend)
            historyList.prepend(newHistoryItem);

            // 2. PREENCHE A TELA DE CONFIRMAÇÃO
            const detailsContainer = document.getElementById('confirmationDetails');
            detailsContainer.innerHTML = `
                <div>
                    <span class="block text-xs font-medium text-gray-500">Data</span>
                    <span class="block text-sm font-semibold text-gray-800">${formattedDate}</span>
                </div>
                <div class="grid grid-cols-2 gap-2">
                    <div>
                        <span class="block text-xs font-medium text-gray-500">Horário</span>
                        <span class="block text-sm font-semibold text-gray-800">${bookingDetails.time}</span>
                    </div>
                    <div>
                        <span class="block text-xs font-medium text-gray-500">Visitantes</span>
                        <span class="block text-sm font-semibold text-gray-800">${visitorsText}</span>
                    </div>
                </div>
            `;
            
            // 3. MOSTRA A TELA DE CONFIRMAÇÃO
            showView('confirmationScreen');
        }

        // --- NOVAS FUNÇÕES (Login, Perfil, etc.) ---

        // Reseta o formulário de "Esqueci a Senha"
        function resetForgotForm() {
            document.getElementById('forgotForm').classList.remove('hidden');
            document.getElementById('forgotSuccess').classList.add('hidden');
            document.getElementById('forgotEmail').value = '';
        }

        // Simula o envio do link de recuperação
        function requestPasswordReset() {
            const email = document.getElementById('forgotEmail').value;
            if (email) { // Simples verificação se o campo não está vazio
                document.getElementById('forgotForm').classList.add('hidden');
                document.getElementById('forgotSuccess').classList.remove('hidden');
            }
        }

        // Simula salvar o perfil
        function saveProfile() {
            const successMsg = document.getElementById('editProfileSuccess');
            successMsg.classList.remove('hidden');
            
            // Esconde a mensagem de sucesso após 3 segundos
            setTimeout(() => {
                successMsg.classList.add('hidden');
            }, 3000);
        }

        // --- LÓGICA DE VER/OCULTAR SENHA ---
        const togglePassword = document.getElementById('togglePassword');
        const passwordInput = document.getElementById('senha');
        const eyeIcon = document.getElementById('eyeIcon');
        const eyeSlashIcon = document.getElementById('eyeSlashIcon');

        function togglePasswordVisibility() {
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                eyeIcon.classList.add('hidden');
                eyeSlashIcon.classList.remove('hidden');
            } else {
                passwordInput.type = 'password';
                eyeIcon.classList.remove('hidden');
                eyeSlashIcon.classList.add('hidden');
            }
        }

        // --- INICIALIZAÇÃO DO APP ---
        
        // Garante que o script rode após o carregamento completo do DOM
        document.addEventListener('DOMContentLoaded', () => {
            
            // Adiciona o listener ao botão de ver/ocultar senha
            togglePassword.addEventListener('click', togglePasswordVisibility);

            // Mostra a tela de login ao iniciar
            showView('loginScreen');
        });

    </script>

</body>
</html>

